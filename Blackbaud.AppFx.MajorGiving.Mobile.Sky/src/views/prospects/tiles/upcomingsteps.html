<bb-tile bb-frog-testid="upcomingStepsTile" bb-wait="locals.loading" bb-tile-header="frogResources.upcomingsteps_tile_header">
    <div bb-frog-testid="upcomingStepsSuccess" ng-if="!locals.loading && !locals.loadError">
        <div bb-tile-section>
            <ul class="list-inline" style="margin-top: 0px; margin-bottom: 0px;">
                <li>
                    <button bb-frog-testid="addStepButton" type="button" class="btn bb-btn-secondary"
                            ng-disabled="!locals.grantedInteractionOrStepAddForm"
                            ng-click="openContactReport({addStep:true})">
                        <i class="fa fa-plus-circle"></i>
                        <span>{{frogResources.recentsteps_addStep}}</span>
                    </button>
                </li>
                <li>
                    <button bb-frog-testid="addInteractionButton" type="button" class="btn bb-btn-secondary"
                            ng-disabled="!locals.grantedInteractionOrStepAddForm"
                            ng-click="openContactReport({addInteraction:true})">
                        <i class="fa fa-plus-circle"></i>
                        <span>{{frogResources.recentsteps_addInteraction}}</span>
                    </button>
                </li>
            </ul>
        </div>
        <div bb-frog-testid="steps" ng-if="locals.upcomingSteps.length > 0">
            <div data-bbauto-index="{{$index}}" bb-tile-section ng-repeat="step in locals.upcomingSteps" ng-if="step">
                <div>
                    <span bb-frog-testid="contactMethod" class="bb-emphasized" ng-if="step.contactMethod">{{::frogResources.label_dash_format.format(step.contactMethod)}}</span>
                    <button class="btn btn-link frog-btn-link-inline" bb-frog-testid="objective" ng-click="openContactReportFromUpcomingStep(step)">{{::step.objective}}</button>
                </div>
                <div class="bb-field-label">
                    <span bb-frog-testid="date">{{frogResources.label_bar_format.format(bbMoment(step.date).format("l"))}}</span>
                    <span bb-frog-testid="planName" ng-if="step.planName">{{::step.planName}}</span>
                    <span bb-frog-testid="noPlan" ng-if="!step.planName">{{::frogResources.noplan}}</span>
                </div>
                <div bb-frog-testid="comments" ng-if="step.comments">
                    <div bb-text-expand="step.comments"
                         bb-text-expand-max-length="25" bb-text-expand-max-expanded-length="200"
                         bb-text-expand-modal-title="frogResources.step_comments_header" />
                </div>
            </div>
        </div>
        <div bb-frog-testid="empty" bb-tile-section ng-if="locals.upcomingSteps.length === 0">
            <div class="bb-no-records">{{::frogResources.nosteps}}</div>
        </div>
    </div>
    <div bb-frog-testid="upcomingStepsError" class="bb-tile-section" ng-if="locals.loadError">
        <div bb-frog-testid="errorMessage" class="center-block frog-prospectview-recentsteps-errormessage">
            {{::locals.loadError}}
        </div>
    </div>
</bb-tile>
